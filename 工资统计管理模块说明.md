# 工资统计管理模块说明

## 概述
本次更新完成了工资统计管理模块的开发，包括：
1. **工人前端**：个人工资统计页面优化
2. **后台管理**：完整的工资统计管理模块

## 一、工人前端修改

### 1. 修改文件：`application/index/view/worker/wage.html`
- ✅ 修改标题为"我的工资统计"
- ✅ 添加个人统计汇总卡片（总报工数量、总工资金额、已确认金额、待确认金额）
- ✅ 优化个人工资图表显示
- ✅ 添加个人工资明细表格
- ✅ 移除全体统计功能，只显示个人数据

### 2. 主要功能
- 个人工资统计汇总
- 个人工资趋势图表
- 个人报工趋势图表
- 个人工资明细列表
- 日期筛选功能

## 二、后台管理模块

### 1. 控制器：`application/admin/controller/scanwork/Wage.php`
**主要方法：**
- `index()` - 工资明细列表
- `summary()` - 工资汇总统计
- `chart()` - 工资趋势图表
- `export()` - 导出工资明细
- `exportSummary()` - 导出工资汇总

### 2. 视图文件
- `application/admin/view/scanwork/wage/index.html` - 工资明细列表页面
- `application/admin/view/scanwork/wage/summary.html` - 工资汇总统计页面
- `application/admin/view/scanwork/wage/chart.html` - 工资图表分析页面

### 3. 后台功能特性
- **工资明细管理**：查看所有员工的工资明细记录
- **工资汇总统计**：按员工分组统计工资数据
- **工资趋势图表**：可视化工资和报工趋势
- **数据导出功能**：支持导出明细和汇总数据
- **筛选功能**：按日期、员工等条件筛选

## 三、菜单权限配置

### 1. SQL文件：`add_wage_menu.sql`
执行此SQL文件将添加：
- 工资统计管理主菜单
- 工资明细、汇总、图表等子菜单
- 相关权限配置

### 2. 菜单结构
```
工厂报工管理
├── 产品管理
├── 型号管理
├── 工序管理
├── 工序工价
├── 订单管理
├── 分工分配
├── 报工管理
├── 生产进度
├── 工资统计管理  ← 新增
│   ├── 工资明细
│   ├── 工资汇总
│   └── 工资图表
├── 二维码管理
└── 员工端管理
```

## 四、使用说明

### 1. 工人端使用
1. 登录工人端
2. 点击"工资统计"
3. 查看个人工资汇总和明细
4. 使用日期筛选查看特定时间段的数据

### 2. 后台管理使用
1. 执行 `add_wage_menu.sql` 添加菜单
2. 登录后台管理
3. 进入"工厂报工管理" > "工资统计管理"
4. 选择相应的功能模块：
   - **工资明细**：查看所有员工的工资记录
   - **工资汇总**：按员工统计工资数据
   - **工资图表**：查看工资趋势分析

### 3. 数据导出
- **导出明细**：导出所有工资记录到CSV文件
- **导出汇总**：导出员工工资汇总数据到CSV文件

## 五、技术特性

### 1. 前端技术
- Tailwind CSS 现代化样式
- ECharts 图表库
- jQuery AJAX 数据交互
- 响应式设计

### 2. 后端技术
- ThinkPHP 5.1 框架
- 数据库查询优化
- CSV 数据导出
- 权限控制

### 3. 数据安全
- 工人只能查看自己的工资数据
- 后台需要相应权限才能访问
- 数据导出支持权限控制

## 六、注意事项

1. **权限配置**：确保管理员角色有工资统计管理权限
2. **数据准确性**：工资计算基于报工记录和工序工价
3. **导出格式**：CSV文件支持中文，使用UTF-8编码
4. **图表显示**：需要网络连接加载ECharts库

## 七、后续优化建议

1. 添加更多图表类型（饼图、雷达图等）
2. 支持更多导出格式（Excel、PDF等）
3. 添加工资计算规则配置
4. 实现工资发放记录管理
5. 添加工资报表打印功能 